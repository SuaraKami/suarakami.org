---
import { getLangFromUrl, useTranslations } from '@/i18n/utils'
import { siteConfig } from '@/site.config'
import VHeader from './Header.vue'
import LanguagePicker from './LanguagePicker.astro'
import LinkLocal from './LinkLocal.astro'
import Logo from './Logo.astro'
import MobileNavigation from './MobileNavigation.vue'
import TimeLocal from './TimeLocal.astro'

const lang = getLangFromUrl(Astro.url)
const t = useTranslations(lang)

const { footer } = siteConfig
---

<VHeader lang="en" client:visible>
  <Logo slot="logo" />

  {
    siteConfig.navigation.map((link, i) => (
      <LinkLocal href={link.to} class="group flex items-center gap-2">
        <span class="font-mono text-xs tracking-wider opacity-40">{String(i + 1).padStart(2, '0')}</span>
        <span
          class={`
            text-sm font-light tracking-wide uppercase transition-opacity
            hover:opacity-50
          `}
        >
          {t(`nav.${link.code}`)}
        </span>
      </LinkLocal>
    ))
  }

  <LanguagePicker
    class={`
      flex items-center gap-2 border-l border-border pl-6 font-mono text-xs
      tracking-wider uppercase opacity-40
    `}
    langClass="opacity-40 transition-opacity hover:opacity-60"
    activeLangClass="opacity-100"
    server:defer
  >
    <span slot="separator">/</span>
  </LanguagePicker>

  <MobileNavigation slot="mobile-nav" lang={lang} client:only="vue">
    <Logo slot="logo" />

    <LanguagePicker
      slot="language-picker"
      class="space-y-3"
      langClass={`
        block text-2xl font-light tracking-tight uppercase opacity-30
        transition-opacity
        hover:opacity-60
      `}
      activeLangClass="opacity-100"
      server:defer
    />

    <div
      slot="footer"
      class={`
        relative col-span-12 overflow-hidden bg-foreground p-6 text-background
      `}
    >
      <div
        class={`
          absolute top-1/2 right-6 -translate-y-1/2 text-[120px] leading-none
          font-light opacity-10
        `}
      >
        <TimeLocal datetime={Date.now()} year="2-digit" />
      </div>
      <p class="relative z-10 text-xs font-medium tracking-widest uppercase">
        {footer.tagline}
      </p>
    </div>
  </MobileNavigation>
</VHeader>
